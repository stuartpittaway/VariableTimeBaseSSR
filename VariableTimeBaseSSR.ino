/*
Latest version found at https://github.com/stuartpittaway/VariableTimeBaseSSR
 Burst Fire Variable Time Base SSR controller (for Arduino)
 Note that this code ignores the zero cross delay/miss fire of the SSR !!!
 A SSR power controller with a "variable time base" changes the time base according to the power requirement. Burst ﬁring with a variable time base usesthe
 smallest possible number of AC cycles to deliver the required percentage power to the heater.
 Why is variable time base preferred over a ﬁxed time base?
 The ON/ OFF switching of the heater happens much more quickly with variable time base. The more quickly the heater is switched, the less temperature variations
 the resistance element has. The nearly constant load current to the heater keeps the heater’s resistance element temperature nearly constant.
 This provides a longer heater life.
 LICENCE
 Attribution-NonCommercial-ShareAlike 3.0 Unported (CC BY-NC-SA 3.0)
 http://creativecommons.org/licenses/by-nc-sa/3.0/
 You are free:
 to Share — to copy, distribute and transmit the work
 to Remix — to adapt the work
 Under the following conditions:
 Attribution — You must attribute the work in the manner specified by the author or licensor (but not in any way that suggests that they endorse you or your use of the work).
 Noncommercial — You may not use this work for commercial purposes.
 Share Alike — If you alter, transform, or build upon this work, you may distribute the resulting work only under the same or similar license to this one.
 All code is copyright Stuart Pittaway, (c)2012.
 */
 
//200 steps over the 100 percent range ie. 0.5% resolution 
const uint8_t totalsteps = 200;
const uint8_t percentdivisor= totalsteps/100;

//Maximum watts of power for the load (eg. 3kw water heater)
const unsigned int max_load_power = 3000;

//Your SSR relay is connected to this pin
#define relay_pin A1

//LED to flash on pulses to indicate performance
#define led_pin 6

//Macros
#define ssr_on digitalWrite(relay_pin,HIGH);digitalWrite(led_pin,LOW);

#define ssr_off digitalWrite(relay_pin,LOW);digitalWrite(led_pin,HIGH);

#define debugvalue(a,b,units) Serial.print(F(a)); Serial.print(b); Serial.println(units);

//Volatile variables which could be modified in both standard code or interrupt routines
volatile unsigned long lastinterruptmillis=0;
volatile double frequency=0;
volatile uint8_t interruptcounter=0;
volatile uint8_t calculatedpercentage=0;
volatile uint8_t bitmapoffset=0;
volatile uint8_t stepindex=0;
volatile uint8_t oncounter=0;


/*
This table provides a variable time base to fire the SSR device rather than a straight on/off delay (fixed time base) 
Cycle over 200 bits, each bit is a mains half cycle ie. 10ms in UK 50hz grid 

The first 0-49% of this table is inversed mirrored to the other 51-100%, to say that 49% is a BOOLEAN NOT of 51%
So we could reduce memory footprint if it becomes a problem
*/
uint8_t PROGMEM bitmaptable[totalsteps+1][25] ={
// 0.0 %
{B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000},
// 0.5 %
{B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000001},
// 1.0 %
{B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00010000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000001},
// 1.5 %
{B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B01000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00001000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000001},
// 2.0 %
{B00000000,B00000000,B00000000,B00000000,B00000000,B00000000,B01000000,B00000000,B00000000,B00000000,B00000000,B00000000,B00010000,B00000000,B00000000,B00000000,B00000000,B00000000,B00000100,B00000000,B00000000,B00000000,B00000000,B00000000,B00000001},
// 2.5 %
{B00000000,B00000000,B00000000,B00000000,B00000001,B00000000,B00000000,B00000000,B00000000,B00000001,B00000000,B00000000,B00000000,B00000000,B00000001,B00000000,B00000000,B00000000,B00000000,B00000001,B00000000,B00000000,B00000000,B00000000,B00000001},
// 3.0 %
{B00000000,B00000000,B00000000,B00000000,B10000000,B00000000,B00000000,B00000000,B01000000,B00000000,B00000000,B00000000,B00100000,B00000000,B00000000,B00000000,B00001000,B00000000,B00000000,B00000000,B00000100,B00000000,B00000000,B00000000,B00000010},
// 3.5 %
{B00000000,B00000000,B00000000,B00010000,B00000000,B00000000,B00000000,B10000000,B00000000,B00000000,B00001000,B00000000,B00000000,B00000000,B01000000,B00000000,B00000000,B00000100,B00000000,B00000000,B00000000,B00100000,B00000000,B00000000,B00000010},
// 4.0 %
{B00000000,B00000000,B00000000,B10000000,B00000000,B00000000,B01000000,B00000000,B00000000,B00100000,B00000000,B00000000,B00010000,B00000000,B00000000,B00001000,B00000000,B00000000,B00000100,B00000000,B00000000,B00000010,B00000000,B00000000,B00000001},
// 4.5 %
{B00000000,B00000000,B00000100,B00000000,B00000000,B00010000,B00000000,B00000000,B01000000,B00000000,B00000001,B00000000,B00000000,B00000010,B00000000,B00000000,B00001000,B00000000,B00000000,B00100000,B00000000,B00000000,B10000000,B00000000,B00000001},
// 5.0 %
{B00000000,B00000000,B00010000,B00000000,B00000001,B00000000,B00000000,B00010000,B00000000,B00000001,B00000000,B00000000,B00010000,B00000000,B00000001,B00000000,B00000000,B00010000,B00000000,B00000001,B00000000,B00000000,B00010000,B00000000,B00000001},
// 5.5 %
{B00000000,B00000000,B01000000,B00000000,B00010000,B00000000,B00000100,B00000000,B00000001,B00000000,B00000000,B01000000,B00000000,B00001000,B00000000,B00000010,B00000000,B00000000,B10000000,B00000000,B00100000,B00000000,B00001000,B00000000,B00000001},
// 6.0 %
{B00000000,B00000001,B00000000,B00000000,B10000000,B00000000,B01000000,B00000000,B01000000,B00000000,B00100000,B00000000,B00010000,B00000000,B00010000,B00000000,B00001000,B00000000,B00000100,B00000000,B00000100,B00000000,B00000010,B00000000,B00000001},
// 6.5 %
{B00000000,B00000010,B00000000,B00000100,B00000000,B00000100,B00000000,B00001000,B00000000,B00010000,B00000000,B00010000,B00000000,B00100000,B00000000,B00100000,B00000000,B01000000,B00000000,B10000000,B00000000,B10000000,B00000001,B00000000,B00000001},
// 7.0 %
{B00000000,B00000100,B00000000,B00010000,B00000000,B01000000,B00000000,B10000000,B00000010,B00000000,B00001000,B00000000,B00010000,B00000000,B01000000,B00000001,B00000000,B00000100,B00000000,B00001000,B00000000,B00100000,B00000000,B10000000,B00000001},
// 7.5 %
{B00000000,B00001000,B00000000,B01000000,B00000010,B00000000,B00001000,B00000000,B01000000,B00000010,B00000000,B00001000,B00000000,B01000000,B00000010,B00000000,B00001000,B00000000,B01000000,B00000010,B00000000,B00001000,B00000000,B01000000,B00000010},
// 8.0 %
{B00000000,B00010000,B00000001,B00000000,B00001000,B00000000,B10000000,B00000100,B00000000,B01000000,B00000010,B00000000,B00100000,B00000001,B00000000,B00010000,B00000000,B10000000,B00001000,B00000000,B01000000,B00000100,B00000000,B00100000,B00000010},
// 8.5 %
{B00000000,B00100000,B00000010,B00000000,B00100000,B00000010,B00000000,B01000000,B00000100,B00000000,B01000000,B00000100,B00000000,B10000000,B00001000,B00000000,B10000000,B00001000,B00000001,B00000000,B00010000,B00000001,B00000000,B00010000,B00000010},
// 9.0 %
{B00000000,B00100000,B00000100,B00000000,B10000000,B00010000,B00000010,B00000000,B01000000,B00001000,B00000001,B00000000,B00100000,B00000010,B00000000,B01000000,B00001000,B00000001,B00000000,B00100000,B00000100,B00000000,B10000000,B00010000,B00000010},
// 9.5 %
{B00000000,B01000000,B00001000,B00000010,B00000000,B01000000,B00010000,B00000010,B00000000,B10000000,B00010000,B00000100,B00000000,B10000000,B00100000,B00000100,B00000001,B00000000,B00100000,B00001000,B00000001,B00000000,B01000000,B00001000,B00000010},
// 10.0 %
{B00000000,B01000000,B00010000,B00000100,B00000001,B00000000,B01000000,B00010000,B00000100,B00000001,B00000000,B01000000,B00010000,B00000100,B00000001,B00000000,B01000000,B00010000,B00000100,B00000001,B00000000,B01000000,B00010000,B00000100,B00000001},
// 10.5 %
{B00000000,B10000000,B00100000,B00010000,B00000100,B00000010,B00000000,B10000000,B01000000,B00010000,B00001000,B00000010,B00000001,B00000000,B01000000,B00100000,B00001000,B00000100,B00000001,B00000000,B10000000,B00100000,B00010000,B00000100,B00000010},
// 11.0 %
{B00000000,B10000000,B01000000,B00100000,B00010000,B00001000,B00000100,B00000010,B00000001,B00000000,B10000000,B01000000,B00100000,B00001000,B00000100,B00000010,B00000001,B00000000,B10000000,B01000000,B00100000,B00010000,B00001000,B00000100,B00000010},
// 11.5 %
{B00000001,B00000000,B10000000,B01000000,B01000000,B00100000,B00010000,B00010000,B00001000,B00000100,B00000100,B00000010,B00000001,B00000000,B10000000,B10000000,B01000000,B00100000,B00100000,B00010000,B00001000,B00001000,B00000100,B00000010,B00000001},
// 12.0 %
{B00000001,B00000001,B00000001,B00000000,B10000000,B10000000,B10000000,B01000000,B01000000,B01000000,B00100000,B00100000,B00100000,B00010000,B00010000,B00010000,B00001000,B00001000,B00001000,B00000100,B00000100,B00000100,B00000010,B00000010,B00000010},
// 12.5 %
{B00000001,B00000001,B00000001,B00000001,B00000001,B00000001,B00000001,B00000001,B00000001,B00000001,B00000001,B00000001,B00000001,B00000001,B00000001,B00000001,B00000001,B00000001,B00000001,B00000001,B00000001,B00000001,B00000001,B00000001,B00000001},
// 13.0 %
{B00000010,B00000010,B00000010,B00000100,B00000100,B00000100,B00001000,B00001000,B00001000,B00010000,B00010000,B00010000,B00100000,B00100000,B00100000,B00100000,B01000000,B01000000,B01000000,B10000000,B10000000,B10000001,B00000001,B00000001,B00000010},
// 13.5 %
{B00000010,B00000100,B00000100,B00001000,B00001000,B00010000,B00100000,B00100000,B01000000,B01000000,B10000001,B00000001,B00000010,B00000010,B00000100,B00001000,B00001000,B00010000,B00010000,B00100000,B01000000,B01000000,B10000000,B10000001,B00000010},
// 14.0 %
{B00000010,B00000100,B00001000,B00010000,B00100000,B01000000,B10000000,B10000001,B00000010,B00000100,B00001000,B00010000,B00100000,B00100000,B01000000,B10000001,B00000010,B00000100,B00001000,B00001000,B00010000,B00100000,B01000000,B10000001,B00000010},
// 14.5 %
{B00000100,B00001000,B00010000,B00100000,B01000000,B10000001,B00000010,B00000100,B00010000,B00100000,B01000000,B10000001,B00000010,B00000100,B00001000,B00010000,B00100000,B10000001,B00000010,B00000100,B00001000,B00010000,B00100000,B01000000,B10000001},
// 15.0 %
{B00000100,B00001000,B00010000,B01000000,B10000001,B00000100,B00001000,B00010000,B01000000,B10000001,B00000100,B00001000,B00010000,B01000000,B10000001,B00000100,B00001000,B00010000,B01000000,B10000001,B00000100,B00001000,B00010000,B01000000,B10000001},
// 15.5 %
{B00000100,B00010000,B00100000,B10000001,B00000100,B00001000,B00100000,B01000001,B00000100,B00001000,B00100000,B01000001,B00000010,B00001000,B00010000,B01000000,B10000010,B00001000,B00010000,B01000000,B10000010,B00000100,B00010000,B00100000,B10000001},
// 16.0 %
{B00000100,B00010000,B01000001,B00000010,B00001000,B00100000,B10000001,B00000100,B00010000,B01000000,B10000010,B00001000,B00100000,B01000001,B00000100,B00010000,B00100000,B10000010,B00001000,B00010000,B01000001,B00000100,B00001000,B00100000,B10000010},
// 16.5 %
{B00000100,B00010000,B01000001,B00000100,B00010000,B01000001,B00000100,B00010000,B01000001,B00000100,B00010000,B01000001,B00000010,B00001000,B00100000,B10000010,B00001000,B00100000,B10000010,B00001000,B00100000,B10000010,B00001000,B00100000,B10000001},
// 17.0 %
{B00001000,B00100000,B10000010,B00001000,B00100000,B10000010,B00010000,B01000001,B00000100,B00010000,B01000001,B00000100,B00100000,B10000010,B00001000,B00100000,B10000010,B00001000,B00100001,B00000100,B00010000,B01000001,B00000100,B00010000,B01000010},
// 17.5 %
{B00001000,B00100000,B10000100,B00010000,B01000010,B00001000,B00100000,B10000100,B00010000,B01000010,B00001000,B00100000,B10000100,B00010000,B01000010,B00001000,B00100000,B10000100,B00010000,B01000010,B00001000,B00100000,B10000100,B00010000,B01000010},
// 18.0 %
{B00001000,B00100001,B00000100,B00100000,B10000100,B00010000,B10000010,B00001000,B01000001,B00001000,B00100001,B00000100,B00100000,B10000010,B00010000,B01000010,B00001000,B01000001,B00001000,B00100000,B10000100,B00010000,B10000010,B00010000,B01000010},
// 18.5 %
{B00001000,B01000001,B00001000,B00100001,B00001000,B00100001,B00000100,B00100001,B00000100,B00100000,B10000100,B00100000,B10000100,B00010000,B10000100,B00010000,B10000010,B00010000,B10000010,B00010000,B01000010,B00010000,B01000010,B00001000,B01000010},
// 19.0 %
{B00001000,B01000010,B00001000,B01000010,B00010000,B01000010,B00010000,B10000010,B00010000,B10000100,B00010000,B10000100,B00100000,B10000100,B00100000,B10000100,B00100001,B00000100,B00100001,B00001000,B00100001,B00001000,B01000001,B00001000,B01000010},
// 19.5 %
{B00001000,B01000010,B00010000,B10000100,B00100000,B10000100,B00100001,B00001000,B01000010,B00010000,B01000010,B00010000,B10000100,B00100001,B00001000,B00100001,B00001000,B01000010,B00010000,B10000100,B00010000,B10000100,B00100001,B00001000,B01000010},
// 20.0 %
{B00001000,B01000010,B00010000,B10000100,B00100001,B00001000,B01000010,B00010000,B10000100,B00100001,B00001000,B01000010,B00010000,B10000100,B00100001,B00001000,B01000010,B00010000,B10000100,B00100001,B00001000,B01000010,B00010000,B10000100,B00100001},
// 20.5 %
{B00010000,B10000100,B00100001,B00001000,B01000010,B00100001,B00001000,B01000010,B00010000,B10000100,B01000010,B00010000,B10000100,B00100001,B00001000,B10000100,B00100001,B00001000,B01000010,B00010001,B00001000,B01000010,B00010000,B10000100,B00100010},
// 21.0 %
{B00010000,B10000100,B00100010,B00010000,B10000100,B01000010,B00010000,B10001000,B01000010,B00010001,B00001000,B01000010,B00100001,B00001000,B01000010,B00100001,B00001000,B01000100,B00100001,B00001000,B10000100,B00100001,B00010000,B10000100,B00100010},
// 21.5 %
{B00010000,B10001000,B01000010,B00100001,B00001000,B10000100,B00100010,B00010000,B10001000,B01000010,B00100001,B00001000,B10000100,B01000010,B00010001,B00001000,B01000100,B00100001,B00010000,B10000100,B01000010,B00010001,B00001000,B01000100,B00100010},
// 22.0 %
{B00010000,B10001000,B01000100,B00100010,B00010001,B00001000,B10000100,B00100010,B00010001,B00001000,B10000100,B01000010,B00100001,B00001000,B10000100,B01000010,B00100001,B00010000,B10001000,B01000010,B00100001,B00010000,B10001000,B01000100,B00100010},
// 22.5 %
{B00010001,B00001000,B10000100,B01000010,B00100001,B00010001,B00001000,B10000100,B01000010,B00100001,B00010001,B00001000,B10000100,B01000010,B00100001,B00010001,B00001000,B10000100,B01000010,B00100001,B00010001,B00001000,B10000100,B01000010,B00100001},
// 23.0 %
{B00010001,B00001000,B10001000,B01000100,B01000010,B00100010,B00010001,B00010000,B10001000,B10000100,B01000100,B00100010,B00100001,B00010000,B10001000,B10000100,B01000100,B00100010,B00100001,B00010001,B00001000,B10001000,B01000100,B01000010,B00100010},
// 23.5 %
{B00010001,B00010000,B10001000,B10001000,B01000100,B01000100,B00100010,B00100010,B00010001,B00010001,B00001000,B10001000,B10000100,B01000100,B01000010,B00100010,B00100001,B00010001,B00010000,B10001000,B10001000,B01000100,B01000100,B00100010,B00100010},
// 24.0 %
{B00010001,B00010001,B00010001,B00001000,B10001000,B10001000,B10000100,B01000100,B01000100,B01000010,B00100010,B00100010,B00100001,B00010001,B00010001,B00010000,B10001000,B10001000,B10001000,B01000100,B01000100,B01000100,B00100010,B00100010,B00100010},
// 24.5 %
{B00010001,B00010001,B00010001,B00010001,B00010001,B00010001,B00001000,B10001000,B10001000,B10001000,B10001000,B10001000,B10000100,B01000100,B01000100,B01000100,B01000100,B01000100,B01000010,B00100010,B00100010,B00100010,B00100010,B00100010,B00100001},
// 25.0 %
{B00010001,B00010001,B00010001,B00010001,B00010001,B00010001,B00010001,B00010001,B00010001,B00010001,B00010001,B00010001,B00010001,B00010001,B00010001,B00010001,B00010001,B00010001,B00010001,B00010001,B00010001,B00010001,B00010001,B00010001,B00010001},
// 25.5 %
{B00100010,B00100010,B00100010,B00100010,B00100010,B00100010,B01000100,B01000100,B01000100,B01000100,B01000100,B01000100,B01001000,B10001000,B10001000,B10001000,B10001000,B10001000,B10001001,B00010001,B00010001,B00010001,B00010001,B00010001,B00010001},
// 26.0 %
{B00100010,B00100010,B00100010,B01000100,B01000100,B01000100,B10001000,B10001000,B10001000,B10010001,B00010001,B00010001,B00100010,B00100010,B00100010,B00100100,B01000100,B01000100,B01001000,B10001000,B10001000,B10001001,B00010001,B00010001,B00010010},
// 26.5 %
{B00100010,B00100010,B01000100,B01000100,B10001000,B10001000,B10010001,B00010001,B00100010,B00100010,B00100100,B01000100,B01001000,B10001000,B10010001,B00010001,B00010010,B00100010,B00100100,B01000100,B01000100,B10001000,B10001001,B00010001,B00010010},
// 27.0 %
{B00100010,B00100100,B01000100,B10001000,B10001001,B00010001,B00100010,B00100100,B01000100,B01001000,B10001001,B00010001,B00100010,B00100010,B01000100,B01001000,B10001000,B10010001,B00010010,B00100010,B01000100,B01000100,B10001000,B10010001,B00010010},
// 27.5 %
{B00100010,B01000100,B01001000,B10001001,B00010001,B00100010,B01000100,B01001000,B10001001,B00010001,B00100010,B01000100,B01001000,B10001001,B00010001,B00100010,B01000100,B01001000,B10001001,B00010001,B00100010,B01000100,B01001000,B10001001,B00010001},
// 28.0 %
{B00100010,B01000100,B10001001,B00010001,B00100010,B01000100,B10001000,B10010001,B00100010,B01000100,B01001000,B10010001,B00100010,B00100100,B01001000,B10010001,B00010010,B00100100,B01001000,B10001001,B00010010,B00100100,B01000100,B10001001,B00010010},
// 28.5 %
{B00100010,B01000100,B10001001,B00010010,B00100100,B01001000,B10010001,B00100010,B01000100,B10001001,B00010010,B00100100,B01001000,B10010001,B00100010,B01000100,B10001001,B00010010,B00100100,B01001000,B10010001,B00100010,B01000100,B10001001,B00010010},
// 29.0 %
{B00100100,B01001000,B10010001,B00100010,B01001000,B10010001,B00100010,B01000100,B10010001,B00100010,B01000100,B10001001,B00100010,B01000100,B10001001,B00010010,B00100100,B10001001,B00010010,B00100100,B01001001,B00010010,B00100100,B01001000,B10010010},
// 29.5 %
{B00100100,B01001001,B00010010,B00100100,B10001001,B00010010,B01000100,B10001001,B00100010,B01001000,B10010001,B00100100,B01001000,B10010010,B00100100,B01001001,B00010010,B01000100,B10001001,B00100010,B01000100,B10010001,B00100010,B01001000,B10010010},
// 30.0 %
{B00100100,B10001001,B00100010,B01001000,B10010010,B00100100,B10001001,B00100010,B01001000,B10010010,B00100100,B10001001,B00100010,B01001000,B10010010,B00100100,B10001001,B00100010,B01001000,B10010010,B00100100,B10001001,B00100010,B01001000,B10010010},
// 30.5 %
{B00100100,B10001001,B00100100,B01001001,B00010010,B01001000,B10010010,B00100100,B10010001,B00100100,B10001001,B00100010,B01001001,B00010010,B01000100,B10010010,B00100100,B10010001,B00100100,B01001001,B00100010,B01001000,B10010010,B01000100,B10010010},
// 31.0 %
{B00100100,B10010001,B00100100,B10001001,B00100100,B10001001,B00100100,B01001001,B00100100,B01001001,B00100010,B01001001,B00100010,B01001001,B00010010,B01001000,B10010010,B01001000,B10010010,B01000100,B10010010,B01000100,B10010010,B00100100,B10010010},
// 31.5 %
{B00100100,B10010010,B00100100,B10010010,B01000100,B10010010,B01001000,B10010010,B01001000,B10010010,B01001001,B00010010,B01001001,B00100010,B01001001,B00100100,B01001001,B00100100,B01001001,B00100100,B10001001,B00100100,B10010001,B00100100,B10010010},
// 32.0 %
{B00100100,B10010010,B01001001,B00010010,B01001001,B00100100,B10001001,B00100100,B10010010,B01000100,B10010010,B01001001,B00100010,B01001001,B00100100,B10010001,B00100100,B10010010,B01001000,B10010010,B01001001,B00100100,B01001001,B00100100,B10010010},
// 32.5 %
{B00100100,B10010010,B01001001,B00100100,B10010010,B00100100,B10010010,B01001001,B00100100,B10010010,B00100100,B10010010,B01001001,B00100100,B10010010,B00100100,B10010010,B01001001,B00100100,B10010010,B00100100,B10010010,B01001001,B00100100,B10010010},
// 33.0 %
{B00100100,B10010010,B01001001,B00100100,B10010010,B01001001,B00100100,B10010010,B01001001,B00100100,B10010010,B01001001,B00100010,B01001001,B00100100,B10010010,B01001001,B00100100,B10010010,B01001001,B00100100,B10010010,B01001001,B00100100,B10010010},
// 33.5 %
{B01001001,B00100100,B10010010,B01001001,B00100100,B10010010,B01001001,B00100100,B10010010,B01001001,B00100100,B10010010,B01001001,B00100100,B10010010,B01001001,B00100100,B10010010,B01001001,B00100100,B10010010,B01001001,B00100100,B10010010,B01001001},
// 34.0 %
{B01001001,B00100100,B10010010,B01001001,B00100100,B10010010,B01010010,B01001001,B00100100,B10010010,B01001001,B00100100,B10010100,B10010010,B01001001,B00100100,B10010010,B01001001,B00100101,B00100100,B10010010,B01001001,B00100100,B10010010,B01001001},
// 34.5 %
{B01001001,B00100100,B10010010,B01010010,B01001001,B00100100,B10010010,B10010010,B01001001,B00100100,B10010100,B10010010,B01001001,B00100100,B10100100,B10010010,B01001001,B00100101,B00100100,B10010010,B01001001,B00101001,B00100100,B10010010,B01001001},
// 35.0 %
{B01001001,B00100100,B10010100,B10010010,B01001001,B01001001,B00100100,B10010100,B10010010,B01001001,B01001001,B00100100,B10010100,B10010010,B01001001,B01001001,B00100100,B10010100,B10010010,B01001001,B01001001,B00100100,B10010100,B10010010,B01001001},
// 35.5 %
{B01001001,B00100101,B00100100,B10010100,B10010010,B01001010,B01001001,B00101001,B00100100,B10010100,B10010010,B01010010,B01001001,B00101001,B00100100,B10100100,B10010010,B01010010,B01001001,B01001001,B00100100,B10100100,B10010010,B10010010,B01001001},
// 36.0 %
{B01001001,B00101001,B00100101,B00100100,B10010100,B10010010,B10010010,B01001010,B01001001,B01001001,B00100101,B00100100,B10100100,B10010010,B10010010,B01010010,B01001001,B01001001,B00101001,B00100100,B10100100,B10010100,B10010010,B01010010,B01001010},
// 36.5 %
{B01001001,B01001001,B00101001,B00100101,B00100100,B10100100,B10010100,B10010010,B10010010,B10010010,B01010010,B01001010,B01001001,B01001001,B00101001,B00100101,B00100101,B00100100,B10100100,B10010100,B10010010,B10010010,B01010010,B01001010,B01001010},
// 37.0 %
{B01001001,B01001001,B01001001,B00101001,B00101001,B00101001,B00100101,B00100101,B00100101,B00100100,B10100100,B10100100,B10100100,B10010100,B10010100,B10010010,B10010010,B10010010,B10010010,B01010010,B01010010,B01010010,B01001010,B01001010,B01001010},
// 37.5 %
{B01001001,B01001001,B01001001,B01001001,B01001001,B01001001,B01001001,B01001001,B01001001,B01001001,B01001001,B01001001,B01001001,B01001001,B01001001,B01001001,B01001001,B01001001,B01001001,B01001001,B01001001,B01001001,B01001001,B01001001,B01001001},
// 38.0 %
{B01001010,B01001010,B01001010,B01010010,B01010010,B01010010,B10010010,B10010010,B10010010,B10010100,B10010100,B10010100,B10100100,B10100100,B10100100,B10100101,B00100101,B00100101,B00101001,B00101001,B00101001,B00101001,B01001001,B01001001,B01001010},
// 38.5 %
{B01001010,B01010010,B01010010,B10010010,B10010100,B10010100,B10100100,B10100101,B00100101,B00101001,B00101001,B01001001,B01001010,B01001010,B01010010,B01010010,B10010010,B10010100,B10010100,B10100100,B10100101,B00100101,B00101001,B00101001,B01001001},
// 39.0 %
{B01001010,B01010010,B10010010,B10010100,B10100100,B10100101,B00101001,B01001001,B01001010,B01010010,B01010010,B10010100,B10100100,B10100101,B00101001,B00101001,B01001010,B01001010,B01010010,B10010100,B10010100,B10100101,B00100101,B00101001,B01001010},
// 39.5 %
{B01001010,B01010010,B10010100,B10100101,B00101001,B00101001,B01001010,B01010010,B10010100,B10100100,B10100101,B00101001,B01001010,B01010010,B10010100,B10010100,B10100101,B00101001,B01001010,B01010010,B01010010,B10010100,B10100101,B00101001,B01001010},
// 40.0 %
{B01010010,B10010100,B10100101,B00101001,B01001010,B01010010,B10010100,B10100101,B00101001,B01001010,B01010010,B10010100,B10100101,B00101001,B01001010,B01010010,B10010100,B10100101,B00101001,B01001010,B01010010,B10010100,B10100101,B00101001,B01001010},
// 40.5 %
{B01010010,B10010100,B10100101,B00101001,B01001010,B10010100,B10100101,B00101001,B01001010,B01010010,B10100101,B00101001,B01001010,B01010010,B10010101,B00101001,B01001010,B01010010,B10010100,B10100101,B01001010,B01010010,B10010100,B10100101,B00101010},
// 41.0 %
{B01010010,B10010100,B10101001,B01001010,B01010010,B10100101,B00101001,B01010010,B10010100,B10100101,B01001010,B01010010,B10100101,B00101001,B01001010,B10010100,B10100101,B00101010,B01010010,B10010101,B00101001,B01001010,B01010100,B10100101,B00101010},
// 41.5 %
{B01010010,B10010101,B00101001,B01010010,B10010101,B00101001,B01001010,B10010100,B10101001,B01001010,B10010100,B10101001,B01001010,B01010100,B10100101,B01001010,B01010100,B10100101,B01001010,B01010010,B10100101,B00101010,B01010010,B10100101,B00101010},
// 42.0 %
{B01010010,B10100101,B00101010,B01010100,B10100101,B01001010,B10010100,B10101001,B01001010,B10010101,B00101001,B01010010,B10100101,B00101010,B01010010,B10100101,B01001010,B01010100,B10101001,B01001010,B10010100,B10101001,B01010010,B10010101,B00101010},
// 42.5 %
{B01010010,B10100101,B01001010,B10010101,B00101010,B01010010,B10100101,B01001010,B10010101,B00101010,B01010010,B10100101,B01001010,B10010101,B00101010,B01010010,B10100101,B01001010,B10010101,B00101010,B01010010,B10100101,B01001010,B10010101,B00101010},
// 43.0 %
{B01010100,B10101001,B01010010,B10100101,B01001010,B10010101,B00101010,B01010100,B10101001,B01010010,B10100101,B01001010,B10010101,B01001010,B10010101,B00101010,B01010100,B10101001,B01010010,B10100101,B01001010,B10010101,B00101010,B01010100,B10101001},
// 43.5 %
{B01010100,B10101001,B01010100,B10101001,B01010010,B10101001,B01010010,B10100101,B01010010,B10100101,B01001010,B10100101,B01001010,B10010101,B01001010,B10010101,B00101010,B10010101,B00101010,B01010101,B00101010,B01010100,B10101010,B01010100,B10101001},
// 44.0 %
{B01010100,B10101010,B01010101,B00101010,B01010101,B00101010,B10010101,B00101010,B10010101,B01001010,B10010101,B01001010,B10100101,B01001010,B10100101,B01010010,B10100101,B01010010,B10101001,B01010010,B10101001,B01010100,B10101001,B01010100,B10101010},
// 44.5 %
{B01010101,B00101010,B10010101,B01001010,B10100101,B01010010,B10101001,B01010100,B10101010,B01010101,B00101010,B10010101,B01001010,B10100101,B01010010,B10101001,B01010100,B10101010,B01010101,B00101010,B10010101,B01001010,B10100101,B01010010,B10101001},
// 45.0 %
{B01010101,B00101010,B10010101,B01010010,B10101001,B01010101,B00101010,B10010101,B01010010,B10101001,B01010101,B00101010,B10010101,B01010010,B10101001,B01010101,B00101010,B10010101,B01010010,B10101001,B01010101,B00101010,B10010101,B01010010,B10101001},
// 45.5 %
{B01010101,B01001010,B10101001,B01010101,B00101010,B10100101,B01010100,B10101010,B10010101,B01010010,B10101010,B01010101,B01001010,B10101001,B01010101,B00101010,B10100101,B01010100,B10101010,B10010101,B01010010,B10101010,B01010101,B01001010,B10101001},
// 46.0 %
{B01010101,B01001010,B10101010,B01010101,B01010010,B10101010,B10010101,B01010010,B10101010,B10010101,B01010100,B10101010,B10100101,B01010100,B10101010,B10100101,B01010101,B00101010,B10101001,B01010101,B00101010,B10101001,B01010101,B01001010,B10101010},
// 46.5 %
{B01010101,B01010010,B10101010,B10100101,B01010101,B00101010,B10101010,B01010101,B01010100,B10101010,B10100101,B01010101,B01001010,B10101010,B10010101,B01010100,B10101010,B10101001,B01010101,B01010010,B10101010,B10010101,B01010101,B00101010,B10101010},
// 47.0 %
{B01010101,B01010100,B10101010,B10101010,B01010101,B01010101,B00101010,B10101010,B10010101,B01010101,B01001010,B10101010,B10100101,B01010101,B01001010,B10101010,B10100101,B01010101,B01010010,B10101010,B10101001,B01010101,B01010100,B10101010,B10101010},
// 47.5 %
{B01010101,B01010101,B01001010,B10101010,B10101001,B01010101,B01010101,B01001010,B10101010,B10101001,B01010101,B01010101,B01001010,B10101010,B10101001,B01010101,B01010101,B01001010,B10101010,B10101001,B01010101,B01010101,B01001010,B10101010,B10101001},
// 48.0 %
{B01010101,B01010101,B01010101,B00101010,B10101010,B10101010,B10010101,B01010101,B01010101,B01001010,B10101010,B10101010,B10100101,B01010101,B01010101,B01010010,B10101010,B10101010,B10101001,B01010101,B01010101,B01010100,B10101010,B10101010,B10101010},
// 48.5 %
{B01010101,B01010101,B01010101,B01010101,B00101010,B10101010,B10101010,B10101010,B10010101,B01010101,B01010101,B01010101,B01001010,B10101010,B10101010,B10101010,B10100101,B01010101,B01010101,B01010101,B01010010,B10101010,B10101010,B10101010,B10101001},
// 49.0 %
{B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B00101010,B10101010,B10101010,B10101010,B10101010,B10101010,B10010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010010,B10101010,B10101010,B10101010,B10101010,B10101010,B10101001},
// 49.5 %
{B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01001010,B10101010,B10101010,B10101010,B10101010,B10101010,B10101010,B10101010,B10101010,B10101010,B10101010,B10101010,B10101001},
// 50.0 %
{B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101},
// 50.5 %
{B10101010,B10101010,B10101010,B10101010,B10101010,B10101010,B10101010,B10101010,B10101010,B10101010,B10101010,B10101010,B10110101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010110},
// 51.0 %
{B10101010,B10101010,B10101010,B10101010,B10101010,B10101010,B11010101,B01010101,B01010101,B01010101,B01010101,B01010101,B01101010,B10101010,B10101010,B10101010,B10101010,B10101010,B10101101,B01010101,B01010101,B01010101,B01010101,B01010101,B01010110},
// 51.5 %
{B10101010,B10101010,B10101010,B10101010,B11010101,B01010101,B01010101,B01010101,B01101010,B10101010,B10101010,B10101010,B10110101,B01010101,B01010101,B01010101,B01011010,B10101010,B10101010,B10101010,B10101101,B01010101,B01010101,B01010101,B01010110},
// 52.0 %
{B10101010,B10101010,B10101010,B11010101,B01010101,B01010101,B01101010,B10101010,B10101010,B10110101,B01010101,B01010101,B01011010,B10101010,B10101010,B10101101,B01010101,B01010101,B01010110,B10101010,B10101010,B10101011,B01010101,B01010101,B01010101},
// 52.5 %
{B10101010,B10101010,B10110101,B01010101,B01010110,B10101010,B10101010,B10110101,B01010101,B01010110,B10101010,B10101010,B10110101,B01010101,B01010110,B10101010,B10101010,B10110101,B01010101,B01010110,B10101010,B10101010,B10110101,B01010101,B01010110},
// 53.0 %
{B10101010,B10101011,B01010101,B01010101,B10101010,B10101010,B11010101,B01010101,B01101010,B10101010,B10110101,B01010101,B01011010,B10101010,B10110101,B01010101,B01011010,B10101010,B10101101,B01010101,B01010110,B10101010,B10101011,B01010101,B01010101},
// 53.5 %
{B10101010,B10101101,B01010101,B01011010,B10101010,B11010101,B01010101,B10101010,B10101011,B01010101,B01011010,B10101010,B10110101,B01010101,B01101010,B10101011,B01010101,B01010110,B10101010,B10101101,B01010101,B01101010,B10101010,B11010101,B01010101},
// 54.0 %
{B10101010,B10110101,B01010101,B10101010,B10101101,B01010101,B01101010,B10101101,B01010101,B01101010,B10101011,B01010101,B01011010,B10101011,B01010101,B01011010,B10101010,B11010101,B01010110,B10101010,B11010101,B01010110,B10101010,B10110101,B01010101},
// 54.5 %
{B10101010,B10110101,B01010110,B10101010,B11010101,B01011010,B10101011,B01010101,B01101010,B10101101,B01010101,B10101010,B10110101,B01010110,B10101010,B11010101,B01011010,B10101011,B01010101,B01101010,B10101101,B01010101,B10101010,B10110101,B01010110},
// 55.0 %
{B10101010,B11010101,B01101010,B10101101,B01010110,B10101010,B11010101,B01101010,B10101101,B01010110,B10101010,B11010101,B01101010,B10101101,B01010110,B10101010,B11010101,B01101010,B10101101,B01010110,B10101010,B11010101,B01101010,B10101101,B01010110},
// 55.5 %
{B10101010,B11010101,B01101010,B10110101,B01011010,B10101101,B01010110,B10101011,B01010101,B10101010,B11010101,B01101010,B10110101,B01011010,B10101101,B01010110,B10101011,B01010101,B10101010,B11010101,B01101010,B10110101,B01011010,B10101101,B01010110},
// 56.0 %
{B10101011,B01010101,B10101010,B11010101,B10101010,B11010101,B01101010,B11010101,B01101010,B10110101,B01101010,B10110101,B01011010,B10110101,B01011010,B10101101,B01011010,B10101101,B01010110,B10101101,B01010110,B10101011,B01010110,B10101011,B01010101},
// 56.5 %
{B10101011,B01010110,B10101011,B01010110,B10101101,B01010110,B10101101,B01011010,B10101101,B01011010,B10110101,B01011010,B10110101,B01101010,B10110101,B01101010,B11010101,B01101010,B11010101,B10101010,B11010101,B10101011,B01010101,B10101011,B01010110},
// 57.0 %
{B10101011,B01010110,B10101101,B01011010,B10110101,B01101010,B11010101,B10101011,B01010110,B10101101,B01011010,B10110101,B01101010,B10110101,B01101010,B11010101,B10101011,B01010110,B10101101,B01011010,B10110101,B01101010,B11010101,B10101011,B01010110},
// 57.5 %
{B10101101,B01011010,B10110101,B01101010,B11010101,B10101101,B01011010,B10110101,B01101010,B11010101,B10101101,B01011010,B10110101,B01101010,B11010101,B10101101,B01011010,B10110101,B01101010,B11010101,B10101101,B01011010,B10110101,B01101010,B11010101},
// 58.0 %
{B10101101,B01011010,B11010101,B10101011,B01011010,B10110101,B01101011,B01010110,B10110101,B01101010,B11010110,B10101101,B01011010,B11010101,B10101101,B01011010,B10110101,B10101011,B01010110,B10110101,B01101011,B01010110,B10101101,B01101010,B11010101},
// 58.5 %
{B10101101,B01101010,B11010110,B10101101,B01101010,B11010110,B10110101,B01101011,B01010110,B10110101,B01101011,B01010110,B10110101,B10101011,B01011010,B10110101,B10101011,B01011010,B10110101,B10101101,B01011010,B11010101,B10101101,B01011010,B11010101},
// 59.0 %
{B10101101,B01101011,B01010110,B10110101,B10101101,B01011010,B11010110,B10101101,B01101011,B01011010,B10110101,B10101101,B01011010,B11010110,B10110101,B01101011,B01011010,B11010101,B10101101,B01101010,B11010110,B10110101,B10101011,B01011010,B11010101},
// 59.5 %
{B10101101,B01101011,B01011010,B11010110,B10110101,B01101011,B01011010,B11010110,B10110101,B10101101,B01011010,B11010110,B10110101,B10101101,B01101010,B11010110,B10110101,B10101101,B01101011,B01011010,B10110101,B10101101,B01101011,B01011010,B11010101},
// 60.0 %
{B10101101,B01101011,B01011010,B11010110,B10110101,B10101101,B01101011,B01011010,B11010110,B10110101,B10101101,B01101011,B01011010,B11010110,B10110101,B10101101,B01101011,B01011010,B11010110,B10110101,B10101101,B01101011,B01011010,B11010110,B10110101},
// 60.5 %
{B10110101,B10101101,B01101011,B01011010,B11010110,B11010110,B10110101,B10101101,B01101011,B01011011,B01011010,B11010110,B10110101,B10101101,B01101011,B01101011,B01011010,B11010110,B10110101,B10101101,B10101101,B01101011,B01011010,B11010110,B10110101},
// 61.0 %
{B10110101,B10101101,B01101101,B01101011,B01011011,B01011010,B11010110,B10110110,B10110101,B10101101,B10101101,B01101011,B01011011,B01011010,B11010110,B11010110,B10110101,B10110101,B10101101,B01101011,B01101011,B01011010,B11011010,B11010110,B10110101},
// 61.5 %
{B10110101,B10101101,B10101101,B01101101,B01101011,B01101011,B01011011,B01011010,B11011010,B11010110,B11010110,B10110110,B10110101,B10110101,B10101101,B10101101,B01101101,B01101011,B01101011,B01011011,B01011010,B11011010,B11010110,B11010110,B10110110},
// 62.0 %
{B10110101,B10110101,B10110101,B10101101,B10101101,B10101101,B01101101,B01101101,B01101101,B01101011,B01101011,B01101011,B01011011,B01011011,B01011011,B01011010,B11011010,B11011010,B11010110,B11010110,B11010110,B11010110,B10110110,B10110110,B10110101},
// 62.5 %
{B10110110,B10110110,B10110110,B10110110,B10110110,B10110110,B10110110,B10110110,B10110110,B10110110,B10110110,B10110110,B10110110,B10110110,B10110110,B10110110,B10110110,B10110110,B10110110,B10110110,B10110110,B10110110,B10110110,B10110110,B10110110},
// 63.0 %
{B10110110,B10110110,B10110110,B11010110,B11010110,B11010110,B11011010,B11011010,B11011010,B11011011,B01011011,B01011011,B01011011,B01101011,B01101011,B01101101,B01101101,B01101101,B01101101,B10101101,B10101101,B10101101,B10110101,B10110101,B10110101},
// 63.5 %
{B10110110,B10110110,B11010110,B11011010,B11011011,B01011011,B01101011,B01101101,B01101101,B01101101,B10101101,B10110101,B10110110,B10110110,B11010110,B11011010,B11011010,B11011011,B01011011,B01101011,B01101101,B01101101,B10101101,B10110101,B10110101},
// 64.0 %
{B10110110,B11010110,B11011010,B11011011,B01101011,B01101101,B01101101,B10110101,B10110110,B10110110,B11011010,B11011011,B01011011,B01101101,B01101101,B10101101,B10110110,B10110110,B11010110,B11011011,B01011011,B01101011,B01101101,B10101101,B10110101},
// 64.5 %
{B10110110,B11011010,B11011011,B01101011,B01101101,B10110101,B10110110,B11010110,B11011011,B01101011,B01101101,B10101101,B10110110,B11010110,B11011011,B01011011,B01101101,B10101101,B10110110,B10110110,B11011011,B01011011,B01101101,B01101101,B10110110},
// 65.0 %
{B10110110,B11011011,B01101011,B01101101,B10110110,B10110110,B11011011,B01101011,B01101101,B10110110,B10110110,B11011011,B01101011,B01101101,B10110110,B10110110,B11011011,B01101011,B01101101,B10110110,B10110110,B11011011,B01101011,B01101101,B10110110},
// 65.5 %
{B10110110,B11011011,B01101101,B10101101,B10110110,B11011011,B01101101,B01101101,B10110110,B11011011,B01101011,B01101101,B10110110,B11011011,B01011011,B01101101,B10110110,B11011010,B11011011,B01101101,B10110110,B11010110,B11011011,B01101101,B10110110},
// 66.0 %
{B10110110,B11011011,B01101101,B10110110,B11011011,B01101101,B10101101,B10110110,B11011011,B01101101,B10110110,B11011011,B01101011,B01101101,B10110110,B11011011,B01101101,B10110110,B11011010,B11011011,B01101101,B10110110,B11011011,B01101101,B10110110},
// 66.5 %
{B10110110,B11011011,B01101101,B10110110,B11011011,B01101101,B10110110,B11011011,B01101101,B10110110,B11011011,B01101101,B10110110,B11011011,B01101101,B10110110,B11011011,B01101101,B10110110,B11011011,B01101101,B10110110,B11011011,B01101101,B10110110},
// 67.0 %
{B11011011,B01101101,B10110110,B11011011,B01101101,B10110110,B11011011,B01101101,B10110110,B11011011,B01101101,B10110110,B11011101,B10110110,B11011011,B01101101,B10110110,B11011011,B01101101,B10110110,B11011011,B01101101,B10110110,B11011011,B01101101},
// 67.5 %
{B11011011,B01101101,B10110110,B11011011,B01101101,B11011011,B01101101,B10110110,B11011011,B01101101,B11011011,B01101101,B10110110,B11011011,B01101101,B11011011,B01101101,B10110110,B11011011,B01101101,B11011011,B01101101,B10110110,B11011011,B01101101},
// 68.0 %
{B11011011,B01101101,B10110110,B11101101,B10110110,B11011011,B01110110,B11011011,B01101101,B10111011,B01101101,B10110110,B11011101,B10110110,B11011011,B01101110,B11011011,B01101101,B10110111,B01101101,B10110110,B11011011,B10110110,B11011011,B01101101},
// 68.5 %
{B11011011,B01101101,B11011011,B01101101,B10111011,B01101101,B10110111,B01101101,B10110111,B01101101,B10110110,B11101101,B10110110,B11011101,B10110110,B11011011,B10110110,B11011011,B10110110,B11011011,B01110110,B11011011,B01101110,B11011011,B01101101},
// 69.0 %
{B11011011,B01101110,B11011011,B01110110,B11011011,B01110110,B11011011,B10110110,B11011011,B10110110,B11011101,B10110110,B11011101,B10110110,B11101101,B10110111,B01101101,B10110111,B01101101,B10111011,B01101101,B10111011,B01101101,B11011011,B01101101},
// 69.5 %
{B11011011,B01110110,B11011011,B10110110,B11101101,B10110111,B01101101,B11011011,B01101110,B11011011,B01110110,B11011101,B10110110,B11101101,B10111011,B01101101,B11011011,B01101110,B11011011,B10110110,B11011101,B10110111,B01101101,B10111011,B01101101},
// 70.0 %
{B11011011,B01110110,B11011101,B10110111,B01101101,B11011011,B01110110,B11011101,B10110111,B01101101,B11011011,B01110110,B11011101,B10110111,B01101101,B11011011,B01110110,B11011101,B10110111,B01101101,B11011011,B01110110,B11011101,B10110111,B01101101},
// 70.5 %
{B11011011,B10110110,B11101101,B11011011,B01110110,B11101101,B10111011,B01110110,B11011101,B10110111,B01101110,B11011011,B10110111,B01101101,B11011011,B10110110,B11101101,B10111011,B01110110,B11011101,B10111011,B01101110,B11011101,B10110111,B01101101},
// 71.0 %
{B11011011,B10110111,B01101110,B11011101,B10110111,B01101110,B11011101,B10111011,B01101110,B11011101,B10111011,B01110110,B11011101,B10111011,B01110110,B11101101,B11011011,B01110110,B11101101,B11011011,B10110110,B11101101,B11011011,B10110111,B01101101},
// 71.5 %
{B11011101,B10111011,B01110110,B11101101,B11011011,B10110111,B01101110,B11011101,B10111011,B01110110,B11101101,B11011011,B10110111,B01101110,B11011101,B10111011,B01110110,B11101101,B11011011,B10110111,B01101110,B11011101,B10111011,B01110110,B11101101},
// 72.0 %
{B11011101,B10111011,B01110110,B11101110,B11011101,B10111011,B01110111,B01101110,B11011101,B10111011,B10110111,B01101110,B11011101,B11011011,B10110111,B01101110,B11101101,B11011011,B10110111,B01110110,B11101101,B11011011,B10111011,B01110110,B11101101},
// 72.5 %
{B11011101,B10111011,B10110111,B01110110,B11101110,B11011101,B10111011,B10110111,B01110110,B11101110,B11011101,B10111011,B10110111,B01110110,B11101110,B11011101,B10111011,B10110111,B01110110,B11101110,B11011101,B10111011,B10110111,B01110110,B11101110},
// 73.0 %
{B11011101,B11011011,B10111011,B01110111,B01110110,B11101110,B11011101,B11011011,B10111011,B10110111,B01110110,B11101110,B11011101,B11011101,B10111011,B10110111,B01110111,B01101110,B11101101,B11011101,B10111011,B10111011,B01110111,B01101110,B11101101},
// 73.5 %
{B11011101,B11011101,B10111011,B10111011,B01110111,B01110111,B01101110,B11101110,B11011101,B11011101,B11011011,B10111011,B10110111,B01110111,B01101110,B11101110,B11101101,B11011101,B11011011,B10111011,B10111011,B01110111,B01110110,B11101110,B11101101},
// 74.0 %
{B11011101,B11011101,B11011101,B10111011,B10111011,B10111011,B01110111,B01110111,B01110111,B01101110,B11101110,B11101110,B11011101,B11011101,B11011101,B11011011,B10111011,B10111011,B10110111,B01110111,B01110111,B01110110,B11101110,B11101110,B11101101},
// 74.5 %
{B11011101,B11011101,B11011101,B11011101,B11011101,B11011101,B10111011,B10111011,B10111011,B10111011,B10111011,B10111011,B10110111,B01110111,B01110111,B01110111,B01110111,B01110111,B01110110,B11101110,B11101110,B11101110,B11101110,B11101110,B11101110},
// 75.0 %
{B11101110,B11101110,B11101110,B11101110,B11101110,B11101110,B11101110,B11101110,B11101110,B11101110,B11101110,B11101110,B11101110,B11101110,B11101110,B11101110,B11101110,B11101110,B11101110,B11101110,B11101110,B11101110,B11101110,B11101110,B11101110},
// 75.5 %
{B11101110,B11101110,B11101110,B11101110,B11101110,B11101110,B11110111,B01110111,B01110111,B01110111,B01110111,B01110111,B01111011,B10111011,B10111011,B10111011,B10111011,B10111011,B10111101,B11011101,B11011101,B11011101,B11011101,B11011101,B11011110},
// 76.0 %
{B11101110,B11101110,B11101110,B11110111,B01110111,B01110111,B01111011,B10111011,B10111011,B10111101,B11011101,B11011101,B11011110,B11101110,B11101110,B11101111,B01110111,B01110111,B01110111,B10111011,B10111011,B10111011,B11011101,B11011101,B11011101},
// 76.5 %
{B11101110,B11101111,B01110111,B01110111,B10111011,B10111011,B11011101,B11011101,B11101110,B11101110,B11110111,B01110111,B01111011,B10111011,B10111101,B11011101,B11011110,B11101110,B11101111,B01110111,B01110111,B10111011,B10111011,B11011101,B11011101},
// 77.0 %
{B11101110,B11110111,B01110111,B10111011,B10111101,B11011101,B11101110,B11101111,B01110111,B01111011,B10111011,B11011101,B11011110,B11101111,B01110111,B01111011,B10111011,B11011101,B11011110,B11101110,B11110111,B01110111,B10111011,B10111101,B11011101},
// 77.5 %
{B11101110,B11110111,B01111011,B10111101,B11011110,B11101110,B11110111,B01111011,B10111101,B11011110,B11101110,B11110111,B01111011,B10111101,B11011110,B11101110,B11110111,B01111011,B10111101,B11011110,B11101110,B11110111,B01111011,B10111101,B11011110},
// 78.0 %
{B11101111,B01110111,B10111011,B11011101,B11101110,B11110111,B01111011,B11011101,B11101110,B11110111,B01111011,B10111101,B11011110,B11110111,B01111011,B10111101,B11011110,B11101111,B01110111,B10111101,B11011110,B11101111,B01110111,B10111011,B11011101},
// 78.5 %
{B11101111,B01110111,B10111101,B11011110,B11110111,B01111011,B11011101,B11101111,B01110111,B10111101,B11011110,B11110111,B01111011,B10111101,B11101110,B11110111,B10111011,B11011110,B11101111,B01111011,B10111101,B11101110,B11110111,B10111011,B11011101},
// 79.0 %
{B11101111,B01111011,B11011101,B11101111,B01111011,B10111101,B11101111,B01110111,B10111101,B11101110,B11110111,B10111101,B11011110,B11110111,B10111101,B11011110,B11110111,B10111011,B11011110,B11110111,B01111011,B11011110,B11101111,B01111011,B11011101},
// 79.5 %
{B11101111,B01111011,B11011110,B11110111,B10111101,B11011110,B11110111,B10111101,B11101111,B01111011,B10111101,B11101111,B01111011,B11011110,B11110111,B01111011,B11011110,B11110111,B10111101,B11101110,B11110111,B10111101,B11101111,B01111011,B11011101},
// 80.0 %
{B11110111,B10111101,B11101111,B01111011,B11011110,B11110111,B10111101,B11101111,B01111011,B11011110,B11110111,B10111101,B11101111,B01111011,B11011110,B11110111,B10111101,B11101111,B01111011,B11011110,B11110111,B10111101,B11101111,B01111011,B11011110},
// 80.5 %
{B11110111,B10111101,B11101111,B01111011,B11011111,B01111011,B11011110,B11110111,B10111101,B11101111,B10111101,B11101111,B01111011,B11011110,B11110111,B11011110,B11110111,B10111101,B11101111,B01111011,B11101111,B01111011,B11011110,B11110111,B10111101},
// 81.0 %
{B11110111,B10111101,B11110111,B10111101,B11101111,B10111101,B11101111,B01111101,B11101111,B01111011,B11101111,B01111011,B11011111,B01111011,B11011111,B01111011,B11011110,B11111011,B11011110,B11110111,B11011110,B11110111,B10111110,B11110111,B10111101},
// 81.5 %
{B11110111,B10111110,B11110111,B11011110,B11110111,B11011110,B11111011,B11011110,B11111011,B11011111,B01111011,B11011111,B01111011,B11101111,B01111011,B11101111,B01111101,B11101111,B01111101,B11101111,B10111101,B11101111,B10111101,B11110111,B10111101},
// 82.0 %
{B11110111,B11011110,B11111011,B11011111,B01111011,B11101111,B01111101,B11110111,B10111110,B11110111,B11011110,B11111011,B11011111,B01111101,B11101111,B10111101,B11110111,B10111110,B11110111,B11011111,B01111011,B11101111,B01111101,B11101111,B10111101},
// 82.5 %
{B11110111,B11011111,B01111011,B11101111,B10111101,B11110111,B11011111,B01111011,B11101111,B10111101,B11110111,B11011111,B01111011,B11101111,B10111101,B11110111,B11011111,B01111011,B11101111,B10111101,B11110111,B11011111,B01111011,B11101111,B10111101},
// 83.0 %
{B11110111,B11011111,B01111101,B11110111,B11011111,B01111101,B11101111,B10111110,B11111011,B11101111,B10111110,B11111011,B11011111,B01111101,B11110111,B11011111,B01111101,B11110111,B11011110,B11111011,B11101111,B10111110,B11111011,B11101111,B10111101},
// 83.5 %
{B11111011,B11101111,B10111110,B11111011,B11101111,B10111110,B11111011,B11101111,B10111110,B11111011,B11101111,B10111110,B11111101,B11110111,B11011111,B01111101,B11110111,B11011111,B01111101,B11110111,B11011111,B01111101,B11110111,B11011111,B01111110},
// 84.0 %
{B11111011,B11101111,B10111110,B11111101,B11110111,B11011111,B01111110,B11111011,B11101111,B10111111,B01111101,B11110111,B11011111,B10111110,B11111011,B11101111,B11011111,B01111101,B11110111,B11101111,B10111110,B11111011,B11110111,B11011111,B01111101},
// 84.5 %
{B11111011,B11101111,B11011111,B01111110,B11111011,B11110111,B11011111,B10111110,B11111011,B11110111,B11011111,B10111110,B11111101,B11110111,B11101111,B10111111,B01111101,B11110111,B11101111,B10111111,B01111101,B11111011,B11101111,B11011111,B01111110},
// 85.0 %
{B11111011,B11110111,B11101111,B10111111,B01111110,B11111011,B11110111,B11101111,B10111111,B01111110,B11111011,B11110111,B11101111,B10111111,B01111110,B11111011,B11110111,B11101111,B10111111,B01111110,B11111011,B11110111,B11101111,B10111111,B01111110},
// 85.5 %
{B11111011,B11110111,B11101111,B11011111,B10111111,B01111110,B11111101,B11111011,B11101111,B11011111,B10111111,B01111110,B11111101,B11111011,B11110111,B11101111,B11011111,B01111110,B11111101,B11111011,B11110111,B11101111,B11011111,B10111111,B01111110},
// 86.0 %
{B11111101,B11111011,B11110111,B11101111,B11011111,B10111111,B01111111,B01111110,B11111101,B11111011,B11110111,B11101111,B11011111,B11011111,B10111111,B01111110,B11111101,B11111011,B11110111,B11110111,B11101111,B11011111,B10111111,B01111110,B11111101},
// 86.5 %
{B11111101,B11111011,B11111011,B11110111,B11110111,B11101111,B11011111,B11011111,B10111111,B10111111,B01111110,B11111110,B11111101,B11111101,B11111011,B11110111,B11110111,B11101111,B11101111,B11011111,B10111111,B10111111,B01111111,B01111110,B11111101},
// 87.0 %
{B11111101,B11111101,B11111101,B11111011,B11111011,B11111011,B11110111,B11110111,B11110111,B11101111,B11101111,B11101111,B11011111,B11011111,B11011111,B11011111,B10111111,B10111111,B10111111,B01111111,B01111111,B01111110,B11111110,B11111110,B11111101},
// 87.5 %
{B11111110,B11111110,B11111110,B11111110,B11111110,B11111110,B11111110,B11111110,B11111110,B11111110,B11111110,B11111110,B11111110,B11111110,B11111110,B11111110,B11111110,B11111110,B11111110,B11111110,B11111110,B11111110,B11111110,B11111110,B11111110},
// 88.0 %
{B11111110,B11111110,B11111110,B11111111,B01111111,B01111111,B01111111,B10111111,B10111111,B10111111,B11011111,B11011111,B11011111,B11101111,B11101111,B11101111,B11110111,B11110111,B11110111,B11111011,B11111011,B11111011,B11111101,B11111101,B11111101},
// 88.5 %
{B11111110,B11111111,B01111111,B10111111,B10111111,B11011111,B11101111,B11101111,B11110111,B11111011,B11111011,B11111101,B11111110,B11111111,B01111111,B01111111,B10111111,B11011111,B11011111,B11101111,B11110111,B11110111,B11111011,B11111101,B11111110},
// 89.0 %
{B11111111,B01111111,B10111111,B11011111,B11101111,B11110111,B11111011,B11111101,B11111110,B11111111,B01111111,B10111111,B11011111,B11110111,B11111011,B11111101,B11111110,B11111111,B01111111,B10111111,B11011111,B11101111,B11110111,B11111011,B11111101},
// 89.5 %
{B11111111,B01111111,B11011111,B11101111,B11111011,B11111101,B11111111,B01111111,B10111111,B11101111,B11110111,B11111101,B11111110,B11111111,B10111111,B11011111,B11110111,B11111011,B11111110,B11111111,B01111111,B11011111,B11101111,B11111011,B11111101},
// 90.0 %
{B11111111,B10111111,B11101111,B11111011,B11111110,B11111111,B10111111,B11101111,B11111011,B11111110,B11111111,B10111111,B11101111,B11111011,B11111110,B11111111,B10111111,B11101111,B11111011,B11111110,B11111111,B10111111,B11101111,B11111011,B11111110},
// 90.5 %
{B11111111,B10111111,B11110111,B11111101,B11111111,B10111111,B11101111,B11111101,B11111111,B01111111,B11101111,B11111011,B11111111,B01111111,B11011111,B11111011,B11111110,B11111111,B11011111,B11110111,B11111110,B11111111,B10111111,B11110111,B11111101},
// 91.0 %
{B11111111,B11011111,B11111011,B11111111,B01111111,B11101111,B11111101,B11111111,B10111111,B11110111,B11111110,B11111111,B11011111,B11111101,B11111111,B10111111,B11110111,B11111110,B11111111,B11011111,B11111011,B11111111,B01111111,B11101111,B11111101},
// 91.5 %
{B11111111,B11011111,B11111101,B11111111,B11011111,B11111101,B11111111,B10111111,B11111011,B11111111,B10111111,B11111011,B11111111,B01111111,B11110111,B11111111,B01111111,B11110111,B11111110,B11111111,B11101111,B11111110,B11111111,B11101111,B11111101},
// 92.0 %
{B11111111,B11101111,B11111110,B11111111,B11110111,B11111111,B01111111,B11111011,B11111111,B10111111,B11111101,B11111111,B11011111,B11111110,B11111111,B11101111,B11111111,B01111111,B11110111,B11111111,B10111111,B11111011,B11111111,B11011111,B11111101},
// 92.5 %
{B11111111,B11110111,B11111111,B10111111,B11111101,B11111111,B11110111,B11111111,B10111111,B11111101,B11111111,B11110111,B11111111,B10111111,B11111101,B11111111,B11110111,B11111111,B10111111,B11111101,B11111111,B11110111,B11111111,B10111111,B11111101},
// 93.0 %
{B11111111,B11111011,B11111111,B11101111,B11111111,B10111111,B11111111,B01111111,B11111101,B11111111,B11110111,B11111111,B11101111,B11111111,B10111111,B11111110,B11111111,B11111011,B11111111,B11110111,B11111111,B11011111,B11111111,B01111111,B11111110},
// 93.5 %
{B11111111,B11111101,B11111111,B11111011,B11111111,B11111011,B11111111,B11110111,B11111111,B11101111,B11111111,B11101111,B11111111,B11011111,B11111111,B11011111,B11111111,B10111111,B11111111,B01111111,B11111111,B01111111,B11111110,B11111111,B11111110},
// 94.0 %
{B11111111,B11111110,B11111111,B11111111,B01111111,B11111111,B10111111,B11111111,B10111111,B11111111,B11011111,B11111111,B11101111,B11111111,B11101111,B11111111,B11110111,B11111111,B11111011,B11111111,B11111011,B11111111,B11111101,B11111111,B11111110},
// 94.5 %
{B11111111,B11111111,B10111111,B11111111,B11101111,B11111111,B11111011,B11111111,B11111110,B11111111,B11111111,B10111111,B11111111,B11110111,B11111111,B11111101,B11111111,B11111111,B01111111,B11111111,B11011111,B11111111,B11110111,B11111111,B11111110},
// 95.0 %
{B11111111,B11111111,B11101111,B11111111,B11111110,B11111111,B11111111,B11101111,B11111111,B11111110,B11111111,B11111111,B11101111,B11111111,B11111110,B11111111,B11111111,B11101111,B11111111,B11111110,B11111111,B11111111,B11101111,B11111111,B11111110},
// 95.5 %
{B11111111,B11111111,B11111011,B11111111,B11111111,B11101111,B11111111,B11111111,B10111111,B11111111,B11111110,B11111111,B11111111,B11111101,B11111111,B11111111,B11110111,B11111111,B11111111,B11011111,B11111111,B11111111,B01111111,B11111111,B11111110},
// 96.0 %
{B11111111,B11111111,B11111111,B01111111,B11111111,B11111111,B10111111,B11111111,B11111111,B11011111,B11111111,B11111111,B11101111,B11111111,B11111111,B11110111,B11111111,B11111111,B11111011,B11111111,B11111111,B11111101,B11111111,B11111111,B11111110},
// 96.5 %
{B11111111,B11111111,B11111111,B11101111,B11111111,B11111111,B11111111,B01111111,B11111111,B11111111,B11110111,B11111111,B11111111,B11111111,B10111111,B11111111,B11111111,B11111011,B11111111,B11111111,B11111111,B11011111,B11111111,B11111111,B11111101},
// 97.0 %
{B11111111,B11111111,B11111111,B11111111,B01111111,B11111111,B11111111,B11111111,B10111111,B11111111,B11111111,B11111111,B11011111,B11111111,B11111111,B11111111,B11110111,B11111111,B11111111,B11111111,B11111011,B11111111,B11111111,B11111111,B11111101},
// 97.5 %
{B11111111,B11111111,B11111111,B11111111,B11111110,B11111111,B11111111,B11111111,B11111111,B11111110,B11111111,B11111111,B11111111,B11111111,B11111110,B11111111,B11111111,B11111111,B11111111,B11111110,B11111111,B11111111,B11111111,B11111111,B11111110},
// 98.0 %
{B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B10111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11101111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111011,B11111111,B11111111,B11111111,B11111111,B11111111,B11111110},
// 98.5 %
{B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B10111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11110111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111110},
// 99.0 %
{B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11101111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111110},
// 99.5 %
{B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111110},
// 100.0 %
{B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111,B11111111}
};


void setup()
{
  Serial.begin(115200);
  //Serial port for debugging output
  pinMode(relay_pin, OUTPUT);
  pinMode(led_pin, OUTPUT);
  ssr_off;
  digitalWrite(led_pin,HIGH);
  
  
  //Nanode, switch LED off!
  //PIN 3
  pinMode(3, INPUT);
  attachInterrupt(1, zerocrossing, RISING );
  
  
  Serial.println(F("Press letters u to increase power (up), d to decrease power level (down),  0 = off, 5= 50%, 1=100%"));
  Serial.print(F("Resolution="));
  Serial.print(1.0/(float)percentdivisor);
  Serial.println("%");
}

//Watts output we want to achieve...
unsigned int setpoint=0;

void loop()
{
  uint8_t sampleloop=10;
  
  while (1) {
    if (sampleloop>0) {
      Serial.print((double)calculatedpercentage/(double)percentdivisor);
      Serial.print("% (");
      Serial.print(((double)max_load_power/100.0)*((double)calculatedpercentage/(double)percentdivisor));
      Serial.print("W) ");
      Serial.print( frequency);
      Serial.println("Hz");
      sampleloop--;
    }
    delay(1000);
    if (Serial.available())
    {
      unsigned char c = Serial.read();

      switch (c) {
        case 'd':
             if (setpoint>0) {
              setpoint--;
              setPercentage(setpoint);
            }
            break;
       case 'u':
           if (setpoint<max_load_power) {
              setpoint++;
              setPercentage(setpoint);
            };
            break;
        case '0':         setPercentage(0);break;
        case '1':         setPercentage((float)max_load_power*0.1);break;
        case '2':         setPercentage((float)max_load_power*0.2);break;
        case '3':         setPercentage((float)max_load_power*0.3);break;
        case '4':         setPercentage((float)max_load_power*0.4);break;
        case '5':         setPercentage((float)max_load_power*0.5);break;
        case '6':         setPercentage((float)max_load_power*0.6);break;
        case '7':         setPercentage((float)max_load_power*0.7);break;
        case '8':         setPercentage((float)max_load_power*0.8);break;
        case '9':         setPercentage((float)max_load_power*0.9);break;       
      }
      
      sampleloop=15;
    }
  }
}

/*
This is our interrupt handler which gets fired every 10ms based on the AC frequency
*/
void zerocrossing()
{
  //Frequency counter, counting AC mains pulses
  if (interruptcounter==0) {
    lastinterruptmillis=millis();
  }
  interruptcounter++;
  if (interruptcounter>100) {
    frequency=(float)100000/(float)((millis()-lastinterruptmillis)*2);
    interruptcounter=0;
  } 

//The actual SSR bit...
  if (getBit(bitmapoffset,stepindex++)==1) {
    ssr_on;
    oncounter++;
  }
  else {
    ssr_off;
  }
  
  if (stepindex==totalsteps) {
    calculatedpercentage=oncounter;
    stepindex=0;
    oncounter=0;   
  } 
}

uint8_t getBit(int bitmapoffset,int location) {
  //Get the nearest byte
  uint8_t value=pgm_read_byte(&(bitmaptable[bitmapoffset][location / 8]));

  uint8_t shift=(7-(location % 8));

  //Extract the bit we want by shifting the bit we want to the far right, and then returning
  return (value >> shift) & 1;
}

void setPercentage(unsigned int watts) {
  debugvalue("Request=",watts,"W");

  //Find the nearest percent and use that...
  double percent=((float)watts/(float)max_load_power*100.0); 
  debugvalue("Real percent=",percent,"%");

  uint8_t value=percent*percentdivisor;

  setpoint=watts;

  //Only reset interrupt if we need to...
  if (bitmapoffset!=value) {  
    debugvalue("New bitmap index=",value,"");

    //Stop the interrupt routine, switch off the SSR and set our new power level
    noInterrupts();
    ssr_off;
    calculatedpercentage=0;
    oncounter=0;
    stepindex=0;
    bitmapoffset=value;
    interrupts();
  }
}


